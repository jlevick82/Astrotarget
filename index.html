<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Go/No-Go v27.4</title>
<style>
  :root{
    --bg:#0d2029;
    --bg-2:#0b1b23;
    --ink:#e8f3f8;
    --ink-dim:#b6c8d1;
    --accent:#3aa0ff;
    --good:#1fc65c;
    --warn:#ffb200;
    --bad:#ff5a5a;
    --card:#112a35;
    --card-2:#0f242d;
    --chip:#0a1b23;
    --chip-ink:#cfe2ea;
    --radius-lg:18px;
    --radius-md:12px;
    --pad:16px;
    --shadow:0 8px 30px rgba(0,0,0,.28);
  }
  body.night{
    --bg:#040707;
    --bg-2:#030505;
    --ink:#ffcdc9;
    --ink-dim:#ffb5b0;
    --accent:#ff6c66;
    --good:#35ff9a;
    --warn:#ffd56a;
    --bad:#ff7b7b;
    --card:#0a0e0f;
    --card-2:#090b0c;
    --chip:#0b0b0b;
    --chip-ink:#ffcfcf;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font:16px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    color:var(--ink); background:radial-gradient(1000px 400px at 20% -5%, #15334420, transparent), var(--bg);
  }
  .wrap{max-width:980px; margin:26px auto 80px; padding:0 18px;}
  h1{font-size:42px; line-height:1.05; margin:6px 0 10px;}
  .sub{opacity:.65; margin-left:8px; font-weight:600}
  .bar{display:flex; gap:14px; margin:12px 0 18px; flex-wrap:wrap}

  /* Buttons / chips */
  .btn{
    display:inline-flex; align-items:center; gap:10px;
    background:linear-gradient(180deg, var(--card), var(--card-2));
    color:var(--ink); border:1px solid #ffffff14;
    padding:10px 16px; border-radius:999px; box-shadow:var(--shadow);
    cursor:pointer; user-select:none;
  }
  .btn:active{transform:translateY(1px); opacity:.9}

  /* cards */
  .card{
    position:relative; overflow:hidden;
    background:linear-gradient(180deg, var(--card), var(--card-2));
    border-radius:var(--radius-lg); box-shadow:var(--shadow);
    padding:var(--pad);                 /* default: NO extra right padding */
    margin:18px 0;
  }
  .card.has-actions{                    /* only these reserve space for the chevron area */
    padding-right:calc(var(--pad) + 52px);
  }

  /* details + chevron */
  details{transition:all .2s ease}
  details > summary{
    list-style:none; cursor:pointer; position:absolute; top:12px; right:12px;
    width:44px; height:44px; border-radius:12px; background:#ffffff10;
    display:grid; place-items:center; border:1px solid #ffffff1a; user-select:none;
  }
  details > summary::-webkit-details-marker{display:none}
  .chev{width:12px; height:12px; border-right:2px solid #ffffffaa; border-bottom:2px solid #ffffffaa; transform:rotate(45deg); transition:transform .18s ease}
  details[open] .chev{transform:rotate(-135deg)}

  /* chips inside cards */
  .chip{
    display:inline-flex; align-items:center; gap:10px;
    padding:8px 14px; background:linear-gradient(180deg, var(--chip), #00000020);
    color:var(--chip-ink); border:1px solid #ffffff14; border-radius:999px;
    font-weight:600;
  }
  .chip .dot{width:36px; height:36px; border-radius:10px; display:grid; place-items:center; font-weight:900}
  .chip.good .dot{background:#0c321b; color:#3bff97; border:1px solid #5affb23d}
  .chip.bad  .dot{background:#321010; color:#ff8a8a; border:1px solid #ff8a8a3d}

  /* Status headline */
  .status-line{font-size:26px; font-weight:800; letter-spacing:.2px; margin:10px 0 6px}
  .status-line .ok{color:var(--good)}
  .status-line .ng{color:var(--bad)}

  /* SKY — compact grid */
  .sky-grid{
    display:grid;
    grid-template-columns:repeat(2, minmax(0, 1fr));
    gap:12px;
  }
  @media (min-width:780px){
    .sky-grid{grid-template-columns:repeat(4, minmax(0, 1fr));}
  }
  .stat{padding:12px 12px; border:1px solid #ffffff12; border-radius:16px; background:#ffffff05}
  .stat .k{font-weight:650; color:var(--ink-dim); font-size:13px}
  .stat .v{font-size:22px; font-weight:800; margin-top:4px}
  .stat .subv{font-size:13px; opacity:.7; margin-top:2px}

  /* Clouds slider + controls */
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .slider{width:100%}
  input[type=range]{width:100%}

  /* Catalog table */
  .tableWrap{
    max-height:420px; overflow:auto; border-radius:16px; border:1px solid #ffffff14;
    background:#00000012;
  }
  table{width:100%; border-collapse:separate; border-spacing:0}
  th, td{padding:14px 16px; border-bottom:1px solid #ffffff10}
  th{position:sticky; top:0; background:linear-gradient(180deg, var(--card), var(--card-2)); z-index:2}
  td:last-child, th:last-child{text-align:center; width:110px}

  .thumb{
    width:72px; height:72px; border-radius:14px; object-fit:cover;
    border:1px solid #ffffff22; background:#00000030; display:inline-block;
  }

  /* Compact mode trims paddings/gaps a bit */
  .compact .card{padding:12px}
  .compact .card.has-actions{padding-right:calc(12px + 48px)}
  .compact .sky-grid{gap:10px}
  .compact .stat{padding:10px}
  .compact .stat .v{font-size:20px}

  a{color:var(--accent); text-decoration:none}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Go/No-Go <span class="sub">v27.4</span></h1>
    <div class="bar">
      <button class="btn" id="compactBtn">Compact On</button>
      <button class="btn" id="nightBtn">Night Mode</button>
    </div>

    <!-- STATUS -->
    <details id="statusCard" class="card has-actions" open>
      <summary aria-label="Toggle status"><span class="chev"></span></summary>
      <div class="chip" id="statePill">
        <span class="dot" id="stateDot">GO</span>
        <span id="stateText">Ready</span>
      </div>
      <div class="status-line" id="statusLine"><span class="ok">GO</span> · Clouds ~0% · Vis 18 km · Astro dark</div>
      <div class="row" style="gap:12px; margin-top:8px">
        <span class="chip" id="updatedChip">Updated --:--</span>
        <span class="chip" id="sunChip">Sun alt -45°</span>
        <span class="chip" id="moonChip">Moon 7%</span>
        <span class="chip" id="altChip">Alt -29°</span>
      </div>
      <div style="opacity:.65; margin-top:12px">Observing recommendation</div>
    </details>

    <!-- SKY -->
    <details id="skyCard" class="card has-actions" open>
      <summary aria-label="Toggle sky"><span class="chev"></span></summary>
      <h2 style="margin:4px 0 12px">Sky</h2>
      <div class="sky-grid">
        <div class="stat">
          <div class="k">Astronomical dark</div>
          <div class="v" id="astroDark">Yes</div>
          <div class="subv" id="sunAlt">Sun alt -44°</div>
        </div>
        <div class="stat">
          <div class="k">Moon illum</div>
          <div class="v" id="moonIllum">7%</div>
          <div class="subv" id="moonAlt">Alt -29°</div>
        </div>
        <div class="stat">
          <div class="k">Humidity</div>
          <div class="v" id="humV">91%</div>
        </div>
        <div class="stat">
          <div class="k">Transparency</div>
          <div class="v" id="transV" style="color:var(--warn)">Bad</div>
          <div class="subv" id="transDetail">AOD 0.12 · PM2.5 2µg/m³ · RH 96% · Vis 12km · ΔT 0.7°C · 0</div>
        </div>
      </div>
    </details>

    <!-- CLOUDS -->
    <details id="cloudsCard" class="card has-actions" open>
      <summary aria-label="Toggle clouds"><span class="chev"></span></summary>
      <h2 style="margin:4px 0 12px">Clouds (avg)</h2>
      <input class="slider" id="cloudSlider" type="range" min="0" max="100" value="0" />
      <div class="row" style="margin-top:10px">
        <button class="btn" id="useBtn">Use</button>
        <button class="btn" id="calcBtn">Calculate</button>
        <span class="chip" id="cloudSrc">From Open-Meteo (hourly) · slider overrides</span>
      </div>
      <div class="row" style="margin-top:12px">
        <span class="chip" id="cloudVal">0%</span>
      </div>
    </details>

    <!-- QUICK SETUP -->
    <details id="quickCard" class="card has-actions" open>
      <summary aria-label="Toggle quick"><span class="chev"></span></summary>
      <h2 style="margin:4px 0 12px">Quick setup</h2>
      <div class="row" style="gap:12px; flex-direction:column">
        <label>Latitude (°)
          <input id="lat" type="text" value="37.16558" style="width:100%; padding:12px 16px; border-radius:999px; border:1px solid #ffffff18; background:#ffffff08; color:var(--ink)" />
        </label>
        <label>Longitude (°)
          <input id="lon" type="text" value="-76.56841" style="width:100%; padding:12px 16px; border-radius:999px; border:1px solid #ffffff18; background:#ffffff08; color:var(--ink)" />
        </label>
        <label>Hours (window)
          <input id="hours" type="number" min="1" max="8" value="3" style="width:100%; padding:12px 16px; border-radius:999px; border:1px solid #ffffff18; background:#ffffff08; color:var(--ink)" />
        </label>
        <div class="row">
          <button class="btn" id="gpsBtn">Use GPS</button>
          <button class="btn" id="nowBtn">Calculate Now</button>
        </div>
      </div>
    </details>

    <!-- TOP 5 -->
    <details id="top5Card" class="card has-actions" open>
      <summary aria-label="Toggle top5"><span class="chev"></span></summary>
      <h2 style="margin:4px 0 12px">Top 5 Recommendations</h2>
      <ol style="margin:0 0 2px 22px; padding:0">
        <li><a href="#">M27</a> — Dumbbell Nebula — alt 82° — 142° from Moon — 196%</li>
        <li><a href="#">M31</a> — Andromeda Galaxy — alt 45° — 140° from Moon — 183%</li>
        <li><a href="#">M33</a> — Triangulum Galaxy — alt 46° — 145° from Moon — 175%</li>
        <li><a href="#">M57</a> — Ring Nebula — alt 44° — 115° from Moon — 155%</li>
        <li><a href="#">M13</a> — Hercules Globular — alt 24° — 90° from Moon — 120%</li>
      </ol>
    </details>

    <!-- CATALOG -->
    <details id="catCard" class="card" open>
      <summary aria-label="Toggle catalog"><span class="chev"></span></summary>
      <h2 style="margin:4px 0 12px">Catalog (subset)</h2>
      <div class="tableWrap" id="catWrap">
        <table>
          <thead>
            <tr>
              <th>Name</th><th>Type</th><th>RA</th><th>Dec</th><th>Image</th>
            </tr>
          </thead>
          <tbody id="catBody">
            <tr>
              <td>Andromeda Galaxy</td><td>GX</td><td>0.71h</td><td>41.3°</td>
              <td><img class="thumb" referrerpolicy="no-referrer"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Andromeda_Galaxy_%28with_h-alpha%29.jpg/128px-Andromeda_Galaxy_%28with_h-alpha%29.jpg"
                alt="M31"></td>
            </tr>
            <tr>
              <td>Triangulum Galaxy</td><td>GX</td><td>1.55h</td><td>30.7°</td>
              <td><img class="thumb" referrerpolicy="no-referrer"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/98/M33LRGB_1.JPG/128px-M33LRGB_1.JPG"
                alt="M33"></td>
            </tr>
            <tr>
              <td>Dumbbell Nebula</td><td>PN</td><td>19.89h</td><td>22.7°</td>
              <td><img class="thumb" referrerpolicy="no-referrer"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/M27_-_Dumbbell_Nebula.jpg/128px-M27_-_Dumbbell_Nebula.jpg"
                alt="M27"></td>
            </tr>
            <tr>
              <td>Ring Nebula</td><td>PN</td><td>18.89h</td><td>33.0°</td>
              <td><img class="thumb" referrerpolicy="no-referrer"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/M57_The_Ring_Nebula.JPG/128px-M57_The_Ring_Nebula.JPG"
                alt="M57"></td>
            </tr>
            <tr>
              <td>Hercules Globular</td><td>GC</td><td>16.70h</td><td>36.5°</td>
              <td><img class="thumb" referrerpolicy="no-referrer"
                src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/M13_-_Great_Globular_Cluster_in_Hercules.jpg/128px-M13_-_Great_Globular_Cluster_in_Hercules.jpg"
                alt="M13"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </details>
  </div>

<script>
  // --- Toggles ---
  const body = document.body;
  const compactBtn = document.getElementById('compactBtn');
  compactBtn.addEventListener('click', ()=>{
    body.classList.toggle('compact');
    compactBtn.textContent = body.classList.contains('compact') ? 'Compact Off' : 'Compact On';
  });
  const nightBtn = document.getElementById('nightBtn');
  nightBtn.addEventListener('click', ()=>{
    body.classList.toggle('night');
    nightBtn.textContent = body.classList.contains('night') ? 'Normal Mode' : 'Night Mode';
  });

  // --- Demo data wiring to show the status line behaving ---
  const cloudSlider = document.getElementById('cloudSlider');
  const cloudVal = document.getElementById('cloudVal');
  const statusLine = document.getElementById('statusLine');
  const statePill = document.getElementById('statePill');
  const stateDot = document.getElementById('stateDot');

  function updateStatus(){
    const c = Number(cloudSlider.value);
    cloudVal.textContent = `${c}%`;
    const go = c <= 60; // simple demo threshold so banner changes as you slide
    stateDot.textContent = go ? 'GO' : 'NO';
    statePill.className = 'chip ' + (go ? 'good' : 'bad');
    statusLine.innerHTML =
      `<span class="${go?'ok':'ng'}">${go?'GO':'NO-GO'}</span> · Clouds ~${c}% · Vis 18 km · Astro dark`;
  }
  cloudSlider.addEventListener('input', updateStatus);
  updateStatus();

  // Buttons below slider: for now, just show we "used" the slider value
  document.getElementById('useBtn').addEventListener('click', ()=> {
    alert(`Using cloud override = ${cloudSlider.value}%`);
  });
  document.getElementById('calcBtn').addEventListener('click', ()=> {
    // stub: pretend Open-Meteo returned 35%
    cloudSlider.value = 35; updateStatus();
    document.getElementById('cloudSrc').textContent = 'From Open-Meteo (hourly) • slider overrides';
  });

  // Mock: set "Updated" chip timestamp
  function fmt(t){ return t.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit', second:'2-digit'}) }
  document.getElementById('updatedChip').textContent = 'Updated ' + fmt(new Date());
</script>
</body>
</html>
